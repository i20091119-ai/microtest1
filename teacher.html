<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>êµì‚¬ìš© ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; padding: 20px; background: #e9ecef; }
        h1 { text-align: center; color: #343a40; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; margin-top: 30px; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); text-align: center; }
        .student-name { font-size: 20px; font-weight: bold; margin-bottom: 10px; display: block; }
        .sensor-val { font-size: 14px; color: #666; margin: 5px 0; }
        .alert { background: #ffcfcf; border: 2px solid #ff0000; animation: blink 1s infinite; }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.7; } 100% { opacity: 1; } }
    </style>
</head>
<body>
    <h1>ğŸ‘¨â€ğŸ« ì‹¤ì‹œê°„ êµì‹¤ ì„¼ì„œ ëª¨ë‹ˆí„°ë§</h1>
    <div id="studentGrid" class="grid">
        <p style="text-align: center; width: 100%;">í•™ìƒë“¤ì˜ ì—°ê²°ì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...</p>
    </div>

    <script>
        // í•™ìƒìš©ê³¼ ë™ì¼í•œ ì„¤ì •
        const firebaseConfig = {
            apiKey: "AIzaSyCINokjlLwLlrE8Qa7SzWGm_-B1V5wr0L8",
            authDomain: "microbit-lab.firebaseapp.com",
            databaseURL: "https://microbit-lab-default-rtdb.firebaseio.com",
            projectId: "microbit-lab",
            storageBucket: "microbit-lab.firebasestorage.app",
            messagingSenderId: "688134998676",
            appId: "1:688134998676:web:ffb0f36fc1de86a61d4281"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // ë°ì´í„°ë² ì´ìŠ¤ ê°ì‹œ
        db.ref('class').on('value', (snapshot) => {
            const grid = document.getElementById('studentGrid');
            const data = snapshot.val();
            
            if (!data) return;
            grid.innerHTML = ""; // í™”ë©´ ì´ˆê¸°í™” í›„ ë‹¤ì‹œ ê·¸ë¦¬ê¸°

            for (let id in data) {
                const s = data[id];
                const isShaking = s.acc > 1500; // í”ë“¤ë¦¼ ê¸°ì¤€ì¹˜
                
                const card = document.createElement('div');
                card.className = `card ${isShaking ? 'alert' : ''}`;
                card.innerHTML = `
                    <span class="student-name">${id}</span>
                    <div class="sensor-val">ğŸŒ¡ï¸ ì˜¨ë„: ${s.temp}Â°C</div>
                    <div class="sensor-val">ğŸ”Š ì†ŒìŒ: ${s.mic}</div>
                    <div class="sensor-val">ğŸ«¨ ê°€ì†ë„: ${s.acc}</div>
                    <div style="font-size:10px; color:#999; margin-top:10px;">
                        ${new Date(s.lastUpdate).toLocaleTimeString()}
                    </div>
                `;
                grid.appendChild(card);
            }
        });
    </script>
</body>
</html>